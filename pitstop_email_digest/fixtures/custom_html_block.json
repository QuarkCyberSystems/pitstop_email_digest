[
 {
  "creation": "2025-07-09 15:31:45.614576",
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<table style=\"width:100%; border-collapse:collapse; margin:30px 0;\">\n  <thead>\n      <tr>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;\">Time Span</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;\">Cars In</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;\">Cars Out</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;\">Average Time To Deliver(Days)</td>\n      </tr>\n  </thead>\n  <tbody id=\"vehicle_movement_tbody\">\n  </tbody>\n</table>",
  "modified": "2025-07-14 12:51:03.925796",
  "name": "Vehicle Movement Daily Monthly",
  "private": 0,
  "roles": [],
  "script": "\n\nvar timespan_obj = {\"daily\":{}, \"monthly\":{}};\nfrappe.call({\n\t\tmethod: \"pitstop_email_digest.utils.vehicle_movement.vehicle_movement.get_vehicle_movement\",\n\t\targs: {\n\t\t    customer_list:[\"C00883\", \"C00276\", \"C01053\"]\n\t\t},\n\t\tfreeze: 1,\n\t\tfreeze_message: __(\"Fetching..\"),\n\t\tcallback: (res) => {\n\t\t\tif(res.message) {\n\t\t\t    console.log(res.message);\n\t\t\t    let tbody_ele = root_element.querySelector('#vehicle_movement_tbody');\n                // Clear any existing content (optional)\n                tbody_ele.innerHTML = \"\";\n\t\t\t    if(res.message.Daily) {\n\t\t\t        timespan_obj[\"daily\"][\"cars_in\"] = res.message.Daily.number_of_vehicle_in[0][\"total_number_cars_in\"]\n\t\t\t        timespan_obj[\"daily\"][\"cars_out\"] = res.message.Daily.number_of_vehicle_out[0][\"total_number_cars_out\"];\n\t\t\t        timespan_obj[\"daily\"][\"average\"] = res.message.Daily.average_time_delivery[0][\"average\"];\n                    \n                    // Create new row for Daily\n                    let dailyRow = document.createElement(\"tr\");\n    \n                    let labelTd = document.createElement(\"td\");\n                    labelTd.textContent = \"Today\";\n                    labelTd.style = \"border:1px solid #d1d8dd;padding:6px 8px;\";\n                    dailyRow.appendChild(labelTd);\n    \n                    for (const key in timespan_obj.daily) {\n                        let td = document.createElement(\"td\");\n                        td.textContent = timespan_obj.daily[key];\n                        td.style = \"border:1px solid #d1d8dd;padding:6px 8px;\";\n                        dailyRow.appendChild(td);\n                    }\n    \n                    tbody_ele.appendChild(dailyRow);\n\t\t\t    }\n\t\t\t    if(res.message.Monthly) {\n\t\t\t        timespan_obj[\"monthly\"][\"cars_in\"] = res.message.Monthly.number_of_vehicle_in[0][\"total_number_cars_in\"]\n\t\t\t        timespan_obj[\"monthly\"][\"cars_out\"] = res.message.Monthly.number_of_vehicle_out[0][\"total_number_cars_out\"]\n\t\t\t        timespan_obj[\"monthly\"][\"average\"] = res.message.Monthly.average_time_delivery[0][\"average\"];\n                    \n                    // Create new row for Monthly\n                    let monthlyRow = document.createElement(\"tr\");\n    \n                    let labelTd = document.createElement(\"td\");\n                    labelTd.textContent = \"This Month\";\n                    labelTd.style = \"border:1px solid #d1d8dd;padding:6px 8px;\";\n                    monthlyRow.appendChild(labelTd);\n    \n                    for (const key in timespan_obj.monthly) {\n                        let td = document.createElement(\"td\");\n                        td.textContent = timespan_obj.monthly[key];\n                        td.style = \"border:1px solid #d1d8dd;padding:6px 8px;\";\n                        monthlyRow.appendChild(td);\n                    }\n                    tbody_ele.appendChild(monthlyRow);\n\t\t\t    }\n\t\t\t}\n\t\t}\n\t});",
  "style": null
 },
 {
  "creation": "2025-07-10 19:49:20.533450",
  "docstatus": 0,
  "doctype": "Custom HTML Block",
  "html": "<style>\n    .td_class {\n        border:1px solid #d1d8dd,\n        padding:6px 8px,\n    }\n</style>\n\n<table id=\"vehicle_movement_table\" style=\"width:100%; border-collapse:collapse; margin:30px 0;\">\n  <thead id=\"vehicle_movement_table_header\">\n      <tr>\n        <td  style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Status</td>\n        <td colspan=\"4\"  style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Mechanical</td>\n        <td colspan=\"4\"  style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Bodyshop - Cash</td>\n        <td colspan=\"4\"  style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Bodyshop - Insurance</td>\n        <td colspan=\"4\"  style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Total BRAC</td>\n      </tr>\n      <tr>\n          <td rowspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">RO Status</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">MTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">YTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">MTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">YTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">MTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">YTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">MTD</td>\n          <td colspan=\"2\" style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">YTD</td>\n      </tr>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">No. Of Cars</td>\n          <td style=\"border:1px solid #d1d8dd;padding:6px 8px;font-weight:bold;background:#f8f8f8;text-align:center;\">Avg. Days</td>\n      </tr>\n  </thead>\n  <tbody id=\"vehicle_movement_tbody_division\">\n  </tbody>\n</table>",
  "modified": "2025-07-17 10:31:56.091601",
  "name": "Vehicle Movement Workshop Division BRAC",
  "private": 0,
  "roles": [],
  "script": "\n\nlet some_class_element = root_element.querySelector('#vehicle_movement_table');\n\nif (some_class_element) {\n\tsome_class_element.style.display = 'none';\n}\n\nwindow.drill_down_ytd = function(ro_status, workshop_division, bill_type, customer_type, timespan) {\n\t\t\n\t\tfrappe.route_options = {\n\t\t\tfrom_date: frappe.defaults.get_user_default(\"year_start_date\"),\n\t\t\tto_date: frappe.datetime.get_today(),\n\t\t\tworkshop_division: workshop_division,\n\t\t\tproject_status: ro_status\n\t\t};\n\t\t\n\t\tif(timespan == \"YTD\") {\n\t\t    frappe.route_options[\"from_date\"] = frappe.defaults.get_user_default(\"year_start_date\");\n\t\t}\n\t\telse if(timespan == \"MTD\") {\n\t\t    frappe.route_options[\"from_date\"] = frappe.datetime.month_start();\n\t\t}\n\t\t\n\t\tif (bill_type) {\n\t\t\tfrappe.route_options[\"billing_type\"] = bill_type;\n\t\t}\n\t\t\n        frappe.set_route(\"query-report\", \"Related Parties I_O\");\n\t};\n\nconst division_dict = [\n\t\t{\"workshop_division\": \"Mechanical\", \"bill_to_customer_check\": null, \"customer_list\":[\"C00883\", \"C00276\", \"C01053\"], \"category\": \"Mechanical\"},\n\t\t{\"workshop_division\": null, \"bill_to_customer_check\": null, \"customer_list\":[\"C00883\", \"C00276\", \"C01053\"], \"category\": \"BRAC\"},\n\t\t{\"workshop_division\": \"Body Shop\", \"bill_to_customer_check\": \"Same\", \"customer_list\":[\"C00883\", \"C00276\", \"C01053\"], \"category\": \"Body Shop - Cash\"},\n\t\t{\"workshop_division\": \"Body Shop\", \"bill_to_customer_check\": \"Insurance\", \"customer_list\":[\"C00883\", \"C00276\", \"C01053\"],  \"category\": \"Body Shop - Insurance\"},\n\t]\n\n\nfrappe.call({\n\t\tmethod: \"pitstop_email_digest.utils.vehicle_movement.vehicle_movement.fetch_ro_project_status_based_workshop_division_for_vehicle\",\n\t\targs: {\n\t\t  division_dict: division_dict,\n\t\t  timespan: \"MTD and YTD\"\n\t\t},\n\t\tfreeze: 1,\n\t\tfreeze_message: __(\"Fetching..\"),\n\t\tcallback: (res) => {\n\t\t    var custom_order = [\n        \t\t\"To Estimate\",\n        \t\t\"Awaiting Approval\",\n        \t\t\"To Assign\",\n        \t\t\"Assigned\",\n        \t\t\"In Progress\",\n        \t\t\"Awaiting Parts\",\n        \t\t\"Parts Arrived\",\n        \t\t\"Tasks Completed\",\n        \t\t\"Awaiting LPO\",\n        \t\t\"Awaiting Gate Pass\",\n        \t\t\"Ready for Collection\",\n        \t\t\"Not Invoiced\",\n        \t\t\"Total Loss\"\n        \t] \n\t\t\tif(res.message) {\n\t\t\t    let tbody_ele = root_element.querySelector('#vehicle_movement_tbody_division');\n\t\t\t    tbody_ele.innerHTML = \"\";\n\t\t\t    let tr_message = \"\";\n\t\t\t    for(let each_project_defined_status of custom_order) {\n    \t\t\t    let found_mechanical_mtd = false, found_mechanical_ytd = false, found_brac_mtd = false, found_brac_ytd = false, \n    \t\t\t    found_bs_cash_mtd = false, found_bs_cash_ytd = false, found_bs_insurance_mtd = false, found_bs_insurance_ytd = false;\n    \t\t\t    \n    \t\t\t    tr_message += \"<tr><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_project_defined_status+\"</td>\";\n    \t\t\t    for(let each_dict_mechanical of res.message.mechanical_category) {\n    \t\t\t        if((each_dict_mechanical.project_status == each_project_defined_status) && (each_dict_mechanical.MTD)){\n    \t\t\t            found_mechanical_mtd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Mechanical`, null, null, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_mechanical.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_mechanical.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t        if((each_dict_mechanical.project_status == each_project_defined_status) && (each_dict_mechanical.YTD)){\n    \t\t\t            found_mechanical_ytd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Mechanical`, null, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_mechanical.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_mechanical.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t    }\n    \t\t\t    if(!found_mechanical_mtd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Mechanical`, null, null, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    if(!found_mechanical_ytd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Mechanical`, null, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    for(let each_dict_bs_cash of res.message.body_shop_cash_category) {\n    \t\t\t        if((each_dict_bs_cash.project_status == each_project_defined_status) && (each_dict_bs_cash.MTD)){\n    \t\t\t            found_bs_cash_mtd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Customer`, null, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_bs_cash.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_bs_cash.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t        if((each_dict_bs_cash.project_status == each_project_defined_status) && (each_dict_bs_cash.YTD)){\n    \t\t\t            found_bs_cash_ytd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Customer`, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_bs_cash.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_bs_cash.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t    }\n    \t\t\t    if(!found_bs_cash_mtd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Customer`, null, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    if(!found_bs_cash_ytd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Customer`, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    for(let each_dict_bs_insurance of res.message.body_shop_insurance_category) {\n    \t\t\t        if((each_dict_bs_insurance.project_status == each_project_defined_status) && (each_dict_bs_insurance.MTD)){\n    \t\t\t            found_bs_insurance_mtd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Insurance`, null, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_bs_insurance.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_bs_insurance.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t        if((each_dict_bs_insurance.project_status == each_project_defined_status) && (each_dict_bs_insurance.YTD)){\n    \t\t\t            found_bs_insurance_ytd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Insurance`, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_bs_insurance.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_bs_insurance.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t    }\n    \t\t\t    if(!found_bs_insurance_mtd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Insurance`, null,  `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    if(!found_bs_insurance_ytd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", `Body Shop`,`Insurance`, null, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    for(let each_dict_brac of res.message.brac_category) {\n    \t\t\t        if((each_dict_brac.project_status == each_project_defined_status) && (each_dict_brac.MTD)){\n    \t\t\t            found_brac_mtd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", null, null, `Brac`, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_brac.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_brac.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t        if((each_dict_brac.project_status == each_project_defined_status) && (each_dict_brac.YTD)){\n    \t\t\t            found_brac_ytd = true;\n    \t\t\t            tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", null, null, `Brac`, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>\"+each_dict_brac.total_ro+\"</td>\"+\"<td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>\"+each_dict_brac.average+\"</td>\"\n    \t\t\t        }\n    \t\t\t    }\n    \t\t\t    if(!found_brac_mtd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", null, null, `Brac`, `MTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    if(!found_brac_ytd) {\n    \t\t\t        tr_message += \"<td onclick='drill_down_ytd(\\\"\"+each_project_defined_status+\"\\\", null, null, `Brac`, `YTD`)' style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;text-decoration: underline;cursor: pointer;'>0</td><td style='border:1px solid #d1d8dd;padding:6px 8px;text-align:center;'>0</td>\"\n    \t\t\t    }\n    \t\t\t    tr_message += \"</tr>\"\n    \t\t\t    tbody_ele.innerHTML = tr_message;\n    \t\t\t    some_class_element.style.display = 'block';\n\t\t\t    }\n            }\n    }\n});\n\n",
  "style": null
 }
]